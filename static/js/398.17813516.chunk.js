/*! For license information please see 398.17813516.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[398],{1884(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},2382(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},2580(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},5711(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},5939(e,s,t){t.d(s,{z:()=>o});var a=t(5043),l=t(3329),r=t(9233),n=t(614),i=t(579);const o=e=>{let{isOpen:s,username:t,currentThreshold:o,isLoading:c=!1,onConfirm:d,onCancel:u}=e;const[x,h]=(0,a.useState)(7),[m,g]=(0,a.useState)(!0),y=(0,a.useRef)(null),p=(0,a.useRef)(null);(0,a.useEffect)(()=>{s&&(void 0!==o&&null!==o?(h(o),g(!0)):null===o?(h(7),g(!1)):(h(7),g(!0)))},[s,o]),(0,a.useEffect)(()=>{if(!s)return;const e=e=>{"Escape"!==e.key||c||u()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s,c,u]),(0,a.useEffect)(()=>{var e;if(!s)return;const t=y.current;if(!t)return;null===(e=p.current)||void 0===e||e.focus();const a=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),l=a[0],r=a[a.length-1],n=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===l&&(e.preventDefault(),null===r||void 0===r||r.focus()):document.activeElement===r&&(e.preventDefault(),null===l||void 0===l||l.focus()))};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[s]);const b=(0,a.useCallback)(e=>{e.target!==e.currentTarget||c||u()},[c,u]),f=(0,a.useCallback)(async()=>{if(c)return;const e=m?x:null;m&&(x<1||x>10)||await d(e)},[c,m,x,d]);return s?(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 ".concat("z-50"),onClick:b,role:"dialog","aria-modal":"true","aria-labelledby":"threshold-modal-title","aria-describedby":"threshold-modal-description",children:(0,i.jsxs)("div",{ref:y,className:"bg-gray-800 rounded-lg p-6 max-w-md w-full border border-gray-700 shadow-xl",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,i.jsxs)("h3",{id:"threshold-modal-title",className:"text-xl font-bold text-white",children:["Follow ",t]}),(0,i.jsx)("button",{onClick:u,disabled:c,className:"text-gray-400 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Close modal",children:(0,i.jsx)(n.A,{size:20})})]}),(0,i.jsxs)("p",{id:"threshold-modal-description",className:"text-gray-300 mb-6",children:["Choose whether you want to receive notifications when ",t," rates items."]}),(0,i.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,i.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 space-y-3",children:[(0,i.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer group",children:[(0,i.jsx)("div",{className:"flex items-center h-6",children:(0,i.jsx)("input",{type:"radio",name:"notification-type",checked:m,onChange:()=>g(!0),disabled:c,className:"w-4 h-4 text-blue-600 cursor-pointer"})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 text-white font-medium",children:[(0,i.jsx)(r.A,{size:16}),(0,i.jsx)("span",{children:"Enable notifications"})]}),(0,i.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:["Get notified when ",t," rates items at or above your threshold"]})]})]}),(0,i.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer group",children:[(0,i.jsx)("div",{className:"flex items-center h-6",children:(0,i.jsx)("input",{type:"radio",name:"notification-type",checked:!m,onChange:()=>g(!1),disabled:c,className:"w-4 h-4 text-blue-600 cursor-pointer"})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 text-white font-medium",children:[(0,i.jsx)(l.A,{size:16}),(0,i.jsx)("span",{children:"Follow silently"})]}),(0,i.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:["Follow ",t," without receiving notifications"]})]})]})]}),m&&(0,i.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,i.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:["Minimum rating threshold: ",(0,i.jsx)("span",{className:"text-white text-lg",children:x})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("input",{type:"range",min:1,max:10,value:x,onChange:e=>h(Number(e.target.value)),disabled:c,className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-blue-600","aria-label":"Rating threshold"}),(0,i.jsxs)("div",{className:"flex justify-between text-xs text-gray-400",children:[(0,i.jsx)("span",{children:1}),(0,i.jsxs)("span",{className:"text-gray-300",children:["Notify when rating \u2265 ",x]}),(0,i.jsx)("span",{children:10})]})]})]})]}),(0,i.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,i.jsx)("button",{ref:p,onClick:u,disabled:c,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-800",children:"Cancel"}),(0,i.jsx)("button",{onClick:f,disabled:c,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 min-w-[100px]",children:c?"Processing...":"Follow"})]})]})}):null}},6210(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},7118(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},8326(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},8398(e,s,t){t.d(s,{UserSearch:()=>A});var a=t(2555),l=t(5043),r=t(7118),n=t(516),i=t(614),o=t(9292),c=t(2580),d=t(5711),u=t(2382),x=t(2024),h=t(6210),m=t(1884),g=t(9463),y=t(8326),p=t(6256),b=t(5939);const f=e=>{const s=new Date(e),t=new Date,a=t.getTime()-s.getTime(),l=Math.floor(a/864e5);return 0===l?"Today":1===l?"Yesterday":l<7?"".concat(l," days ago"):l<30?"".concat(Math.floor(l/7)," weeks ago"):s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:s.getFullYear()!==t.getFullYear()?"numeric":void 0})};var j=t(8546),w=t(4362),v=t(579);const N=()=>(0,v.jsx)("div",{className:"space-y-3",children:[...Array(5)].map((e,s)=>(0,v.jsxs)("div",{className:"bg-gray-800 p-4 rounded border border-gray-700 animate-pulse",children:[(0,v.jsx)("div",{className:"h-4 bg-gray-700 rounded w-1/4 mb-2"}),(0,v.jsx)("div",{className:"h-3 bg-gray-700 rounded w-1/2"})]},s))}),k=e=>{let{hasSearch:s}=e;return(0,v.jsxs)("div",{className:"text-center py-12",children:[(0,v.jsx)(r.A,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,v.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:"No users found"}),(0,v.jsx)("p",{className:"text-sm text-gray-500 max-w-sm mx-auto",children:s?"Try adjusting your search or filters to find users":"No users are registered yet"})]})},A=e=>{let{onViewUser:s}=e;const[t,r]=(0,l.useState)([]),[A,C]=(0,l.useState)(0),[S,F]=(0,l.useState)(0),[z,E]=(0,l.useState)(""),[R,U]=(0,l.useState)(""),[D,L]=(0,l.useState)(!1),[M,T]=(0,l.useState)(!1),[P,H]=(0,l.useState)({by:"lastActive",direction:"desc"}),[q,O]=(0,l.useState)(!1),[Y,B]=(0,l.useState)(!1),[K,G]=(0,l.useState)(new Set),{alert:I,showSuccess:V,showError:J,handleApiError:Q}=(0,j.M)(),[W,X]=(0,l.useState)(null),[Z,$]=(0,l.useState)(""),_=(0,l.useRef)(null),ee=(0,l.useRef)(!1),se=(0,l.useRef)(!1);(0,l.useEffect)(()=>{se.current=!0,ee.current=!0,te(0)},[]),(0,l.useEffect)(()=>(_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{U(z)},500),()=>{_.current&&clearTimeout(_.current)}),[z]),(0,l.useEffect)(()=>{se.current&&te(0)},[R,M,P]);const te=(0,l.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s?B(!0):O(!0),ee.current=!0,C(e);try{const t=await p.FH.users.searchUsersBasic({username:R||void 0,adminOnly:M,sortBy:P.by,sortDirection:P.direction,page:e,size:20});r(t.content),F(t.totalPages),s&&V("Users list refreshed")}catch(t){Q(t,"Failed to load users"),r([]),F(0)}finally{O(!1),B(!1)}},[R,M,P]),ae=(0,l.useCallback)(()=>{ee.current=!0,te(0)},[te]),le=(0,l.useCallback)(()=>{te(A,!0)},[te,A]),re=(0,l.useCallback)(()=>{E(""),U("")},[]),ne=(0,l.useCallback)(e=>{H(s=>s.by===e?{by:e,direction:"asc"===s.direction?"desc":"asc"}:{by:e,direction:"desc"})},[]),ie=(0,l.useCallback)(e=>P.by!==e?null:(0,v.jsx)("span",{className:"ml-1 text-blue-400",children:"desc"===P.direction?"\u2193":"\u2191"}),[P]),oe=(0,l.useCallback)((e,s)=>{X(e),$(s)},[]),ce=(0,l.useCallback)(async e=>{if(null!==W){G(e=>new Set(e).add(W));try{await p.FH.follows.followUser(W,null!==e&&void 0!==e?e:0),r(e=>e.map(e=>e.id===W?(0,a.A)((0,a.A)({},e),{},{isFollowing:!0}):e)),V("Successfully followed ".concat(Z)),X(null),$("")}catch(s){Q(s,"Failed to follow user")}finally{G(e=>{const s=new Set(e);return s.delete(W),s})}}},[W,Z]),de=(0,l.useCallback)(async(e,s)=>{if(s.stopPropagation(),!K.has(e)){G(s=>new Set(s).add(e));try{await p.FH.follows.unfollowUser(e),r(s=>s.map(s=>s.id===e?(0,a.A)((0,a.A)({},s),{},{isFollowing:!1}):s)),V("Successfully unfollowed user")}catch(t){Q(t,"Failed to unfollow user"),r(s=>s.map(s=>s.id===e?(0,a.A)((0,a.A)({},s),{},{isFollowing:!0}):s))}finally{G(s=>{const t=new Set(s);return t.delete(e),t})}}},[K]),ue=(0,l.useCallback)(e=>{te(e)},[te]),xe=M,he=ee.current;return(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsx)(w.i,{alert:I}),(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-white",children:"User Search"}),(0,v.jsx)("button",{onClick:le,disabled:Y||!he,className:"p-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Refresh users",children:(0,v.jsx)(n.A,{size:20,className:Y?"animate-spin":""})})]}),(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsxs)("div",{className:"flex-1 relative",children:[(0,v.jsx)("input",{type:"text",value:z,onChange:e=>E(e.target.value),onKeyPress:e=>"Enter"===e.key&&ae(),placeholder:"Search users by username...",className:"w-full px-4 py-2 pr-10 bg-gray-700 text-white rounded border border-gray-600 focus:border-blue-500 focus:outline-none","aria-label":"Search users"}),z&&(0,v.jsx)("button",{onClick:re,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white transition-colors","aria-label":"Clear search",children:(0,v.jsx)(i.A,{size:18})})]}),(0,v.jsx)("button",{onClick:ae,disabled:q,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:(0,v.jsx)(o.A,{size:20})})]}),(0,v.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,v.jsxs)("button",{onClick:()=>L(!D),className:"flex items-center gap-2 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded border border-gray-700 transition-colors",children:[(0,v.jsx)(c.A,{size:18}),D?"Hide Filters":"Show Filters",D?(0,v.jsx)(d.A,{size:18}):(0,v.jsx)(u.A,{size:18}),xe&&!D&&(0,v.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-blue-600 text-xs rounded font-medium",children:"Active"})]}),P.by&&he&&(0,v.jsxs)("div",{className:"text-sm text-gray-400",children:["Sorted by:"," ",(0,v.jsx)("span",{className:"text-blue-400",children:(me=P.by,{registrationDate:"Registration Date",lastActive:"Last Active",ratingsCount:"Ratings",followersCount:"Followers"}[me]||me)})," ","(","desc"===P.direction?"Newest/Highest First":"Oldest/Lowest First",")"]})]}),D&&(0,v.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg border border-gray-700 space-y-4",children:[(0,v.jsx)("h3",{className:"text-white font-medium",children:"Filters"}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"User Type:"}),(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsx)("button",{onClick:()=>T(!1),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors ".concat(M?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-blue-600 text-white"),children:"All Users"}),(0,v.jsx)("button",{onClick:()=>T(!0),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors ".concat(M?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"Admins Only"})]})]}),xe&&(0,v.jsx)("button",{onClick:()=>T(!1),className:"text-sm text-blue-400 hover:text-blue-300 transition-colors",children:"Clear filters"})]}),q?(0,v.jsx)(N,{}):0===t.length?(0,v.jsx)(k,{hasSearch:!!R||M}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"overflow-x-auto",children:(0,v.jsxs)("table",{className:"w-full",role:"table",children:[(0,v.jsx)("thead",{className:"bg-gray-700 text-gray-300 text-sm",children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Username"}),(0,v.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Role"}),(0,v.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Email"}),(0,v.jsxs)("th",{scope:"col",className:"px-4 py-3 text-left cursor-pointer hover:bg-gray-600 transition-colors",onClick:()=>ne("registrationDate"),children:["Registration",ie("registrationDate")]}),(0,v.jsxs)("th",{scope:"col",className:"px-4 py-3 text-left cursor-pointer hover:bg-gray-600 transition-colors",onClick:()=>ne("lastActive"),children:["Last Active",ie("lastActive")]}),(0,v.jsxs)("th",{scope:"col",className:"px-4 py-3 text-center cursor-pointer hover:bg-gray-600 transition-colors",onClick:()=>ne("ratingsCount"),children:["Ratings",ie("ratingsCount")]}),(0,v.jsxs)("th",{scope:"col",className:"px-4 py-3 text-center cursor-pointer hover:bg-gray-600 transition-colors",onClick:()=>ne("followersCount"),children:["Followers",ie("followersCount")]}),(0,v.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Actions"})]})}),(0,v.jsx)("tbody",{className:"text-sm",children:t.map(e=>{const t=K.has(e.id);return(0,v.jsxs)("tr",{className:"border-b border-gray-700 hover:bg-gray-800 cursor-pointer transition-colors",onClick:()=>s(e.id),children:[(0,v.jsx)("td",{className:"px-4 py-3 text-white font-medium",children:e.username}),(0,v.jsx)("td",{className:"px-4 py-3",children:(0,v.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("ADMIN"===e.role?"bg-purple-600 text-white":"bg-gray-700 text-gray-200"),children:e.role})}),(0,v.jsx)("td",{className:"px-4 py-3 text-gray-400",children:e.email||(0,v.jsx)("span",{className:"text-gray-600",children:"Hidden"})}),(0,v.jsx)("td",{className:"px-4 py-3 text-gray-300",children:f(e.createdAt)}),(0,v.jsx)("td",{className:"px-4 py-3 text-gray-300",children:e.lastActive?f(e.lastActive):"-"}),(0,v.jsx)("td",{className:"px-4 py-3 text-center text-gray-300",children:e.ratingsCount}),(0,v.jsx)("td",{className:"px-4 py-3 text-center text-gray-300",children:e.followersCount}),(0,v.jsx)("td",{className:"px-4 py-3 text-right",children:(0,v.jsx)("div",{className:"flex gap-2 justify-end",onClick:e=>e.stopPropagation(),children:e.isFollowing?(0,v.jsx)("button",{onClick:s=>de(e.id,s),disabled:t,className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded text-xs flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed transition-colors min-w-[90px] justify-center","aria-label":"Unfollow ".concat(e.username),children:t?(0,v.jsx)(x.A,{size:14,className:"animate-spin"}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.A,{size:14}),"Following"]})}):(0,v.jsxs)("button",{onClick:s=>{s.stopPropagation(),oe(e.id,e.username)},disabled:t,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-xs flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed transition-colors min-w-[90px] justify-center","aria-label":"Follow ".concat(e.username),children:[(0,v.jsx)(m.A,{size:14}),"Follow"]})})})]},e.id)})})]})}),S>1&&(0,v.jsxs)("div",{className:"flex items-center justify-center gap-4",role:"navigation","aria-label":"Pagination",children:[(0,v.jsxs)("button",{onClick:()=>ue(A-1),disabled:0===A||q,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2","aria-label":"Previous page",children:[(0,v.jsx)(g.A,{size:20}),"Previous"]}),(0,v.jsxs)("span",{className:"text-gray-300",children:["Page ",A+1," of ",S]}),(0,v.jsxs)("button",{onClick:()=>ue(A+1),disabled:A>=S-1||q,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2","aria-label":"Next page",children:["Next",(0,v.jsx)(y.A,{size:20})]})]})]}),(0,v.jsx)(b.z,{isOpen:null!==W,username:Z,isLoading:null!==W&&K.has(W),onConfirm:ce,onCancel:()=>{X(null),$("")}})]});var me}},9292(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},9463(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])}}]);
//# sourceMappingURL=398.17813516.chunk.js.map