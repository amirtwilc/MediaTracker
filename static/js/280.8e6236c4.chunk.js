/*! For license information please see 280.8e6236c4.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[280],{1360(e,t,a){a.d(t,{A:()=>s});const s=(0,a(5228).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1382(e,t,a){a.d(t,{e:()=>s});const s=e=>{switch(e){case"MOVIE":return"bg-yellow-600";case"SERIES":return"bg-blue-600";case"GAME":return"bg-green-600";default:return"bg-gray-600"}}},2280(e,t,a){a.d(t,{AdvancedUserSearch:()=>w});var s=a(2555),r=a(5043);const n=(0,a(5228).A)("film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);var i=a(7118),l=a(7819),c=a(614),d=a(9292),o=a(2054),x=a(1360),m=a(9463),u=a(8326),h=a(6256),g=a(1382),p=a(8546),y=a(4362),b=a(579);const f=10,j=()=>(0,b.jsx)("div",{className:"space-y-3",children:[...Array(5)].map((e,t)=>(0,b.jsxs)("div",{className:"bg-gray-800 p-4 rounded border border-gray-700 animate-pulse",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-700 rounded w-3/4 mb-2"}),(0,b.jsx)("div",{className:"h-3 bg-gray-700 rounded w-1/2"})]},t))}),N=e=>{let{type:t}=e;return(0,b.jsxs)("div",{className:"text-center py-12",children:["media"===t?(0,b.jsx)(n,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}):(0,b.jsx)(i.A,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:"media"===t?"No media found":"No users found"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 max-w-sm mx-auto",children:"media"===t?"Try adjusting your search terms":"No users match these rating criteria. Try adjusting the rating ranges."})]})},v=e=>{let{isOpen:t,item:a,onConfirm:s,onCancel:n}=e;const[i,c]=(0,r.useState)(1),[d,o]=(0,r.useState)(f),[x,m]=(0,r.useState)(""),u=(0,r.useRef)(null),h=(0,r.useRef)(null);(0,r.useEffect)(()=>{var e;t&&(c(1),o(f),m(""),null===(e=h.current)||void 0===e||e.focus())},[t]),(0,r.useEffect)(()=>{if(!t)return;const e=e=>{"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,n]),(0,r.useEffect)(()=>{if(!t)return;const e=u.current;if(!e)return;const a=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),s=a[0],r=a[a.length-1],n=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===s&&(e.preventDefault(),null===r||void 0===r||r.focus()):document.activeElement===r&&(e.preventDefault(),null===s||void 0===s||s.focus()))};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[t]);return t&&a?(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:e=>{e.target===e.currentTarget&&n()},role:"dialog","aria-modal":"true","aria-labelledby":"range-modal-title",children:(0,b.jsxs)("div",{ref:u,className:"bg-gray-800 rounded-lg p-6 max-w-md w-full border border-gray-700 shadow-xl",children:[(0,b.jsx)("h3",{id:"range-modal-title",className:"text-xl font-bold text-white mb-4",children:"Select Rating Range"}),(0,b.jsx)("p",{className:"text-gray-300 mb-2 font-medium",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mb-6",children:"Find users who rated this item within this range"}),x&&(0,b.jsxs)("div",{className:"mb-4 p-3 bg-red-900 bg-opacity-20 border border-red-700 text-red-400 rounded-lg flex items-center gap-2",children:[(0,b.jsx)(l.A,{size:16}),(0,b.jsx)("span",{className:"text-sm",children:x})]}),(0,b.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"min-rating",className:"block text-sm text-gray-300 mb-2",children:["Minimum Rating: ",i]}),(0,b.jsx)("input",{id:"min-rating",type:"range",min:1,max:f,value:i,onChange:e=>{return(t=Number(e.target.value))<1&&(t=1),t>f&&(t=f),c(t),t>d&&o(t),void m("");var t},className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-blue-600"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,b.jsx)("span",{children:1}),(0,b.jsx)("span",{children:f})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"max-rating",className:"block text-sm text-gray-300 mb-2",children:["Maximum Rating: ",d]}),(0,b.jsx)("input",{id:"max-rating",type:"range",min:1,max:f,value:d,onChange:e=>{return(t=Number(e.target.value))<1&&(t=1),t>f&&(t=f),o(t),t<i&&c(t),void m("");var t},className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-blue-600"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,b.jsx)("span",{children:1}),(0,b.jsx)("span",{children:f})]})]}),(0,b.jsx)("div",{className:"bg-gray-700 p-3 rounded",children:(0,b.jsxs)("p",{className:"text-sm text-gray-300",children:["Range: ",(0,b.jsxs)("span",{className:"text-white font-medium",children:[i," - ",d]})]})})]}),(0,b.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,b.jsx)("button",{ref:h,onClick:n,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900",children:"Cancel"}),(0,b.jsx)("button",{onClick:()=>{i>d?m("Minimum rating cannot be greater than maximum rating"):s(i,d)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900",children:"Add to Search"})]})]})}):null},w=e=>{let{onViewUser:t}=e;const[a,n]=(0,r.useState)(""),[i,l]=(0,r.useState)(""),[f,w]=(0,r.useState)([]),[k,C]=(0,r.useState)(!1),[R,A]=(0,r.useState)(!1),[S,M]=(0,r.useState)([null]),[E,I]=(0,r.useState)(0),[z,F]=(0,r.useState)(0),[P,T]=(0,r.useState)(0),[U,D]=(0,r.useState)(!1),[q,H]=(0,r.useState)([]),[L,O]=(0,r.useState)(!1),[V,G]=(0,r.useState)(null),[K,B]=(0,r.useState)([]),[Y,J]=(0,r.useState)(!1),[Q,W]=(0,r.useState)(!1),[X,Z]=(0,r.useState)(0),[$,_]=(0,r.useState)(0),{alert:ee,showSuccess:te,showError:ae,handleApiError:se}=(0,p.M)(),re=(0,r.useRef)(null),ne=(0,r.useRef)(null);(0,r.useEffect)(()=>(re.current&&clearTimeout(re.current),re.current=setTimeout(()=>{l(a)},500),()=>{re.current&&clearTimeout(re.current)}),[a]);const ie=(0,r.useCallback)(async(e,t)=>{if(i.trim()){C(!0),A(!0),I(e);try{const a=await h.FH.media.searchMediaItemsCursor({query:i,cursorName:null===t||void 0===t?void 0:t.name,cursorId:null===t||void 0===t?void 0:t.id,limit:20});w(a.items),D(a.hasMore),T(a.totalCount),F(Math.ceil(a.totalCount/20)),a.hasMore&&a.nextCursor&&M(t=>{const s=[...t];return e+1>=s.length&&s.push(a.nextCursor),s})}catch(a){se(a,"Failed to perform search"),w([])}finally{C(!1)}}},[i]),le=(0,r.useCallback)(()=>{I(0),M([null]),ie(0,null)},[ie]),ce=(0,r.useCallback)(e=>{G(e),O(!0)},[]),de=(0,r.useCallback)((e,t)=>{V&&q.length<5&&(H(a=>[...a,{mediaItem:V,minRating:e,maxRating:t}]),O(!1),G(null),te("Added ".concat(V.name," to search criteria")))},[V,q.length]),oe=(0,r.useCallback)(e=>{H(t=>t.filter((t,a)=>a!==e))},[]),xe=(0,r.useCallback)((e,t,a)=>{H(r=>{const n=[...r];return n[e]=(0,s.A)((0,s.A)({},n[e]),{},{minRating:t,maxRating:a}),n})},[]),me=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0!==q.length){W(!0),J(!0),Z(e);try{const t={itemRatingCriteria:q.map(e=>({mediaItemId:e.mediaItem.id,minRating:e.minRating,maxRating:e.maxRating})),sortBy:"lastActive",sortDirection:"desc",page:e,size:20},a=await h.FH.users.searchUsersAdvanced(t);B(a.content),_(a.totalPages),0===e&&ne.current&&ne.current.scrollIntoView({behavior:"smooth",block:"start"})}catch(t){se(t,"Failed to search users"),B([])}finally{J(!1)}}else ae("Please add at least one media item with rating criteria")},[q]);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(y.i,{alert:ee}),q.length>0&&(0,b.jsxs)("div",{className:"bg-gray-800 p-4 rounded border border-gray-700",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,b.jsxs)("h3",{className:"text-white font-medium",children:["Selected Items (",q.length,"/",5,")"]}),(0,b.jsx)("button",{onClick:()=>me(0),disabled:0===q.length,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium disabled:opacity-50",children:"Search Users"})]}),(0,b.jsx)("div",{className:"space-y-2",children:q.map((e,t)=>(0,b.jsxs)("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-white font-medium truncate",children:e.mediaItem.name}),(0,b.jsxs)("p",{className:"text-sm text-gray-400",children:[(0,b.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat((0,g.e)(e.mediaItem.category)," text-white mr-2"),children:e.mediaItem.category}),e.mediaItem.year||"N/A"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("label",{className:"text-xs text-gray-400 whitespace-nowrap",children:"Min:"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("button",{onClick:()=>{const a=Math.min(e.minRating+1,e.maxRating,10);xe(t,a,e.maxRating)},className:"px-1 py-0 bg-gray-600 hover:bg-gray-500 text-white text-xs leading-none h-3 flex items-center justify-center",title:"Increase minimum",children:"\u25b2"}),(0,b.jsx)("input",{min:"1",max:e.maxRating,value:e.minRating,onChange:a=>{const s=Number(a.target.value);s>=1&&s<=e.maxRating&&xe(t,s,e.maxRating)},className:"w-12 px-1 py-0.5 bg-gray-600 text-white text-center text-sm border-0 focus:ring-1 focus:ring-blue-500 focus:outline-none"}),(0,b.jsx)("button",{onClick:()=>{const a=Math.max(e.minRating-1,1);xe(t,a,e.maxRating)},className:"px-1 py-0 bg-gray-600 hover:bg-gray-500 text-white text-xs leading-none h-3 flex items-center justify-center",title:"Decrease minimum",children:"\u25bc"})]})]}),(0,b.jsx)("span",{className:"text-gray-400 text-sm",children:"to"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("label",{className:"text-xs text-gray-400 whitespace-nowrap",children:"Max:"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("button",{onClick:()=>{const a=Math.min(e.maxRating+1,10);xe(t,e.minRating,a)},className:"px-1 py-0 bg-gray-600 hover:bg-gray-500 text-white text-xs leading-none h-3 flex items-center justify-center",title:"Increase maximum",children:"\u25b2"}),(0,b.jsx)("input",{min:e.minRating,max:"10",value:e.maxRating,onChange:a=>{const s=Number(a.target.value);s>=e.minRating&&s<=10&&xe(t,e.minRating,s)},className:"w-12 px-1 py-0.5 bg-gray-600 text-white text-center text-sm border-0 focus:ring-1 focus:ring-blue-500 focus:outline-none"}),(0,b.jsx)("button",{onClick:()=>{const a=Math.max(e.maxRating-1,e.minRating);xe(t,e.minRating,a)},className:"px-1 py-0 bg-gray-600 hover:bg-gray-500 text-white text-xs leading-none h-3 flex items-center justify-center",title:"Decrease maximum",children:"\u25bc"})]})]}),(0,b.jsx)("button",{onClick:()=>oe(t),className:"p-1 hover:bg-gray-600 rounded text-red-400 flex-shrink-0",title:"Remove item",children:(0,b.jsx)(c.A,{size:18})})]})]},t))})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-white",children:"Search for Media Items"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",value:a,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&le(),placeholder:"Search for movies, series, or games...",className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded border border-gray-600 focus:border-blue-500 focus:outline-none","aria-label":"Search media"}),(0,b.jsx)("button",{onClick:le,disabled:k||!a.trim(),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:(0,b.jsx)(d.A,{size:20})})]}),R&&(0,b.jsx)("div",{className:"space-y-4",children:k?(0,b.jsx)(j,{}):0===f.length?(0,b.jsx)(N,{type:"media"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",role:"table",children:[(0,b.jsx)("thead",{className:"bg-gray-700 text-gray-300 text-sm",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Category"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Name"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Year"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Genre"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-right",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"text-sm",children:f.map(e=>{const t=q.some(t=>t.mediaItem.id===e.id),a=!t&&q.length<5;return(0,b.jsxs)("tr",{className:"border-b border-gray-700 hover:bg-gray-800 transition-colors",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat((0,g.e)(e.category)," text-white font-medium"),children:e.category})}),(0,b.jsx)("td",{className:"px-4 py-3 text-white font-medium",children:e.name}),(0,b.jsx)("td",{className:"px-4 py-3 text-gray-300",children:e.year||"-"}),(0,b.jsx)("td",{className:"px-4 py-3 text-gray-300",children:e.genres.map(e=>e.name).join(", ")||"-"}),(0,b.jsx)("td",{className:"px-4 py-3 text-right",children:(0,b.jsx)("button",{onClick:()=>ce(e),disabled:!a,className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-xs disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1 ml-auto transition-colors","aria-label":t?"".concat(e.name," already added"):"Add ".concat(e.name),children:t?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.A,{size:14}),"Added"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(x.A,{size:14}),"Add"]})})})]},e.id)})})]})}),z>1&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-4",role:"navigation","aria-label":"Media pagination",children:[(0,b.jsxs)("button",{onClick:()=>ie(E-1,S[E-1]),disabled:0===E||k,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2","aria-label":"Previous page",children:[(0,b.jsx)(m.A,{size:20}),"Previous"]}),(0,b.jsxs)("span",{className:"text-gray-300",children:["Page ",E+1," of ",z,P>0&&(0,b.jsxs)("span",{className:"text-xs text-gray-400 ml-2",children:["(",P," items)"]})]}),(0,b.jsxs)("button",{onClick:()=>ie(E+1,S[E+1]),disabled:!U||k,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2","aria-label":"Next page",children:["Next",(0,b.jsx)(u.A,{size:20})]})]})]})})]}),Q&&(0,b.jsxs)("div",{ref:ne,className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-white",children:"Matching Users"}),Y?(0,b.jsx)(j,{}):0===K.length?(0,b.jsx)(N,{type:"users"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",role:"table",children:[(0,b.jsx)("thead",{className:"bg-gray-700 text-gray-300 text-sm",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Username"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Role"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-left",children:"Email"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-center",children:"Ratings"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-3 text-center",children:"Followers"})]})}),(0,b.jsx)("tbody",{className:"text-sm",children:K.map(e=>(0,b.jsxs)("tr",{className:"border-b border-gray-700 hover:bg-gray-800 cursor-pointer transition-colors",onClick:()=>t(e.id),children:[(0,b.jsx)("td",{className:"px-4 py-3 text-white font-medium",children:e.username}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("ADMIN"===e.role?"bg-purple-600 text-white":"bg-gray-700 text-gray-200"),children:e.role})}),(0,b.jsx)("td",{className:"px-4 py-3 text-gray-400",children:e.email||(0,b.jsx)("span",{className:"text-gray-600",children:"Hidden"})}),(0,b.jsx)("td",{className:"px-4 py-3 text-center text-gray-300",children:e.ratingsCount}),(0,b.jsx)("td",{className:"px-4 py-3 text-center text-gray-300",children:e.followersCount})]},e.id))})]})}),$>1&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-4",role:"navigation","aria-label":"User pagination",children:[(0,b.jsxs)("button",{onClick:()=>me(X-1),disabled:0===X||Y,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2","aria-label":"Previous page",children:[(0,b.jsx)(m.A,{size:20}),"Previous"]}),(0,b.jsxs)("span",{className:"text-gray-300",children:["Page ",X+1," of ",$]}),(0,b.jsxs)("button",{onClick:()=>me(X+1),disabled:X>=$-1||Y,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2","aria-label":"Next page",children:["Next",(0,b.jsx)(u.A,{size:20})]})]})]})]}),(0,b.jsx)(v,{isOpen:L,item:V,onConfirm:de,onCancel:()=>{O(!1),G(null)}})]})}},7118(e,t,a){a.d(t,{A:()=>s});const s=(0,a(5228).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},8326(e,t,a){a.d(t,{A:()=>s});const s=(0,a(5228).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9292(e,t,a){a.d(t,{A:()=>s});const s=(0,a(5228).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},9463(e,t,a){a.d(t,{A:()=>s});const s=(0,a(5228).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])}}]);
//# sourceMappingURL=280.8e6236c4.chunk.js.map